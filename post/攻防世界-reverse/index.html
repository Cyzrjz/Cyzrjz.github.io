<!doctype html>
<html
  lang="zh-cn" 
  
    data-theme-mode="auto"
  
>
  <head>
    
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/>







  

<title>
  攻防世界 Reverse | Cyzrjz
</title>
<meta
  name="description"
  content="逆向刷题"
/>










<script>
  window.siteConfig = JSON.parse("{\"anchor_icon\":null,\"clipboard\":{\"copyright\":{\"content\":\"本文版权：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！\",\"count\":50,\"enable\":false},\"fail\":\"复制失败 (ﾟ⊿ﾟ)ﾂ\",\"success\":\"复制成功(*^▽^*)\"},\"code_block\":{\"expand\":true},\"icon_font\":\"4552607_0khxww3tj3q9\",\"outdate\":{\"daysago\":180,\"enable\":false,\"message\":\"本文最后更新于 {time}，请注意文中内容可能已经发生变化。\"}}");
</script>






  







  
  
  
    
  

  
  
  
    
  

  
    

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  rel="preload"
  as="style"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"
  media="print"
  onload="this.media='all'"
/>







  <link
    rel="preload"
    href="//at.alicdn.com/t/c/font_4552607_0khxww3tj3q9.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
  />



  







  
 <link rel="stylesheet" href="/css/loader.min.ac746e154f756f8220326eeb52a719f142ab038be5a8ddf30ea5ef15ef2356ea.css" />




  <meta property="og:type" content="website" />
  <meta property="og:title" content="攻防世界 Reverse | Cyzrjz" />
  <meta
    property="og:description"
    content="逆向刷题"
  />
  <meta property="og:url" content="https://cyzrjz.github.io/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/" />
  <meta
    property="og:site_name"
    content="W31c0me t0 My610g"
  />
  <meta
    property="og:image"
    content="/"
  />
  <meta property="article:author" content="Cyzrjz" />
  <meta property="article:published_time" content="2025-04-25T20:36:13&#43;08:00" />
  <meta property="article:modified_time" content="2025-04-25T20:36:13&#43;08:00" />
  
    <meta property="article:tag" content="逆向训练" />
  
  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:image" content="/" />
  
  
  
  
  




<link rel="shortcut icon" href="/favicon.ico">








  
 <link rel="stylesheet" href="/css/main.min.f733dcb5f5f43503ece2a5817d54461ea9641518f66ab17c660d22bb4c1acecd.css" />





  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />






  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/katex@0.16.9/dist/katex.min.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />








  

  
  
    
  
  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"
    
    
    
    
    integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"
  ></script>





  


  <link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css" />





    
  </head>
  <body>
    
    
  <div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi rotate">
        
          <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
          M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg>
        
      </div>
      <div class="loading-word">少女祈祷中...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>


<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        
<div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon rotate'>
          
            
              &#xe62b;
            
          
        </div>
        <a class="main-nav-link" href="/">首页</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon rotate'>
          
            
              &#xe62b;
            
          
        </div>
        <a class="main-nav-link" href="/archives">归档</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon rotate'>
          
            
              &#xe62b;
            
          
        </div>
        <a class="main-nav-link" href="/about">关于</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon rotate'>
          
            
              &#xe62b;
            
          
        </div>
        <a class="main-nav-link" href="/friend">友链</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="搜索"></a>
    
  </nav>
</div>
<header id="header">
  
    
      
        <picture>
          
        </picture>
        
          <img  fetchpriority="high" src="/images/my/banner.png" alt="攻防世界 Reverse">
        
      
    
  

  <div id="header-outer">
    <div id="header-title">
      
        
        
          
        
  
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">攻防世界 Reverse</h1>
          </a>
        
      
  
      
        
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>
        <div id="content"
          class="sidebar-left"
            >
          <aside id="sidebar">
  
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div
      class="sidebar-wrap"
      data-aos="fade-up"
    >
      
        
          <div class="sidebar-toc-sidebar">
            <div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#1-echo-servern3">1. echo-server[N3]</a>
      <ul>
        <li><a href="#分析">分析</a></li>
        <li><a href="#exp">exp</a></li>
      </ul>
    </li>
    <li><a href="#2-catch-men3">2. catch-me[N3]</a>
      <ul>
        <li><a href="#分析-1">分析</a></li>
        <li><a href="#exp-1">exp</a></li>
      </ul>
    </li>
    <li><a href="#3-梅津美治郎n3">3. 梅津美治郎[N3]</a>
      <ul>
        <li><a href="#分析-2">分析</a></li>
        <li><a href="#exp-2">exp</a></li>
      </ul>
    </li>
    <li><a href="#4-csaw2013reversing2n4">4. csaw2013reversing2[N4]</a>
      <ul>
        <li><a href="#分析-3">分析</a></li>
        <li><a href="#exp-3">exp</a></li>
      </ul>
    </li>
    <li><a href="#5-mfc逆向-200n4">5. mfc逆向-200[N4]</a>
      <ul>
        <li><a href="#分析-4">分析</a></li>
        <li><a href="#exp-4">exp</a></li>
      </ul>
    </li>
    <li><a href="#6-reverse-boxn5">6. reverse-box[N5]</a>
      <ul>
        <li><a href="#分析-5">分析</a></li>
        <li><a href="#exp-5">exp</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
          </div>
          <div class="sidebar-common-sidebar hidden">
            
<div class="sidebar-author">
  <img
    data-src="/avatar/avatar.png"
    data-sizes="auto"
    alt="Cyzrjz"
    class="lazyload"
  />
  <div class="sidebar-author-name">Cyzrjz</div>
  <div class="sidebar-description">静籁永恒</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    
    <div class="sidebar-state-number">11</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">
      0
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">14</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="首页"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>
        
          
            &#xe62b;
          
        
      </div>
      <div class="sidebar-menu-link">首页</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="归档"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>
        
          
            &#xe62b;
          
        
      </div>
      <div class="sidebar-menu-link">归档</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="关于"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>
        
          
            &#xe62b;
          
        
      </div>
      <div class="sidebar-menu-link">关于</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/friend"
        aria-label="友链"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>
        
          
            &#xe62b;
          
        
      </div>
      <div class="sidebar-menu-link">友链</div>
    </div>
  
</div>

          </div>
        
      

      
        
          <div class="sidebar-btn-wrapper" style="position:static">
            <div class="sidebar-toc-btn current"></div>
            <div class="sidebar-common-btn"></div>
          </div>
        
      
    </div>
  </div>

  <div class="sidebar-widget">
    
  </div>
  
</aside>

          <section id="main">
  <article
  class="h-entry article"
  itemprop="blogPost"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div
    class="article-inner"
    data-aos="fade-up"
  >
    <div class="article-meta">
      <div class="article-date">
  <span
    class="article-date-link"
    data-aos="zoom-in"
  >
    <time datetime="2025-04-25 20:36:13 &#43;0800 &#43;0800" itemprop="datePublished"
      >2025-04-25</time
    >
    <time style="display: none;" id="post-update-time"
      >2025-04-25</time
    >
  </span>
</div>

      <div class="article-category">
  
</div>

    </div>
    <div class="hr-line"></div>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <h2 id="1-echo-servern3">
<a class="header-anchor" href="#1-echo-servern3"></a>
1. echo-server[N3]
</h2><p><a href="/process/Reverse/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/1.zip">echo-server</a></p>
<h3 id="分析">
<a class="header-anchor" href="#%e5%88%86%e6%9e%90"></a>
分析
</h3><p>本题主要考察花指令分析
执行程序，发现没有环境，使用下面的指令安装环境</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yay -S lib32-openssl-1.0
</span></span></code></pre></div><p>IDA查看
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image.png" alt="alt text">
查看反汇编
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-1.png" alt="alt text">
将爆红的call转为数据，可以看到有<code>db 0E8h</code>，是常见的花指令，用NOP填充后重新用IDA打开，后续大多是这样操作
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-2.png" alt="alt text"></p>
<p><img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-3.png" alt="alt text"></p>
<p><img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-4.png" alt="alt text"></p>
<p><img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-5.png" alt="alt text"></p>
<p>选中第一段按下P，注意不要选到nop了
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-6.png" alt="alt text"></p>
<p>可以成功反编译了，但是还有一处异常
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-7.png" alt="alt text">
查看反汇编窗口，这里应该是一个判断，不应该跳转到自己的开头，然后判断失败后直接执行exit，</p>
<p>结合上一段汇编代码，这里应该是上一段的接续，直接nop掉不应该存在的跳转指令
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-9.png" alt="alt text">
nop掉后，逻辑就清晰了，再次F5反汇编
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-10.png" alt="alt text">
如图，反汇编正常了
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-11.png" alt="alt text"></p>
<p>接下来分析程序逻辑，开始动调，输入<code>F1@gA</code>，查看汇编代码
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-12.png" alt="alt text">
这里应该跳转的，但是没跳转，直接执行exit，试试直接修改为jmp</p>
<p><img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-13.png" alt="alt text">
输出<code>F8C60EB40BF66919A77C4BD88D45DEF4</code>
提交，发现这就是flag</p>
<h3 id="exp">
<a class="header-anchor" href="#exp"></a>
exp
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">F8C60EB40BF66919A77C4BD88D45DEF4</span>
</span></span></code></pre></div><h2 id="2-catch-men3">
<a class="header-anchor" href="#2-catch-men3"></a>
2. catch-me[N3]
</h2><p><a href="/process/Reverse/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/2.zip">catch-me</a></p>
<h3 id="分析-1">
<a class="header-anchor" href="#%e5%88%86%e6%9e%90-1"></a>
分析
</h3><p>拖入IDA，查看反汇编</p>
<p><img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-14.png" alt="alt text">
从byte_6012A8到dword_6012AC占用连续的空间，猜测是同一个数组</p>
<p>动调得到v3的值为<code>0xB11924E1</code>
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-15.png" alt="alt text"></p>
<p>得到
<code>getenv(&quot;CTF&quot;) = v3 ^ 0xFEEBFEEB</code>
猜测
<code>getenv(&quot;ASIS&quot;) == getenv(&quot;CTF&quot;)</code></p>
<p>中间一大堆的SSE指令没对haystack做修改，先跳过，想了解可以看</p>
<p><a href="/post/sse%E6%8C%87%E4%BB%A4%E9%9B%86%E5%AD%A6%E4%B9%A0/">SSE指令集学习</a></p>
<h4 id="解法1">
<a class="header-anchor" href="#%e8%a7%a3%e6%b3%951"></a>
解法1
</h4><p>程序通过getenv函数获取环境变量的值，那么直接往环境变量里写入正确的值就行了</p>
<p>可以通过export设置临时环境变量，终端关闭后自动清除</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">(</span>通过printf可以导入十六进制整数类型，值得积累<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">ASIS</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&#34;\x0a\xda\xf2\x4f&#34;</span><span class="k">)</span><span class="s2">&#34;</span> <span class="c1">#注意参数是从低位到高位的</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CTF</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&#34;\x0a\xda\xf2\x4f&#34;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span></code></pre></div><p><img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-16.png" alt="alt text"></p>
<h4 id="解法2">
<a class="header-anchor" href="#%e8%a7%a3%e6%b3%952"></a>
解法2
</h4><p>纯逆向，下面贴出exp</p>
<h3 id="exp-1">
<a class="header-anchor" href="#exp-1"></a>
exp
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">key1</span> <span class="o">=</span> <span class="mh">0xFEEBFEEB</span>
</span></span><span class="line"><span class="cl"><span class="n">key2</span> <span class="o">=</span> <span class="mh">0xB11924E1</span>
</span></span><span class="line"><span class="cl"><span class="n">key3</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">key1</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;little&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">key3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span> <span class="c1">#0x0A,0xDA,0xF2,0x4F</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0x2B</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xB1</span><span class="p">,</span><span class="mh">0x19</span><span class="o">&amp;</span><span class="mh">0xFD</span><span class="p">,</span><span class="mh">0x24</span><span class="o">&amp;</span><span class="mh">0xDF</span><span class="p">,</span><span class="mh">0xE1</span><span class="o">&amp;</span><span class="mh">0xBF</span><span class="p">,</span><span class="mh">0x0A</span><span class="p">,</span><span class="mh">0xDA</span><span class="p">,</span><span class="mh">0xF2</span><span class="p">,</span><span class="mh">0x4F</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ASIS</span><span class="se">{{</span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="se">}}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="3-梅津美治郎n3">
<a class="header-anchor" href="#3-%e6%a2%85%e6%b4%a5%e7%be%8e%e6%b2%bb%e9%83%8en3"></a>
3. 梅津美治郎[N3]
</h2><p><a href="/process/Reverse/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/3.zip">梅津美治郎</a></p>
<h3 id="分析-2">
<a class="header-anchor" href="#%e5%88%86%e6%9e%90-2"></a>
分析
</h3><p>运行程序
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-17.png" alt="alt text">
拖入IDA，查看反汇编
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-19.png" alt="alt text">
动调，解释如图
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-22.png" alt="alt text"></p>
<p>这里要注意到</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">lpProcName</span> <span class="o">=</span> <span class="o">::</span><span class="n">lpProcName</span><span class="p">;</span>                    <span class="c1">// lpProcName = AddVectoredExceptionHandler
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">hModule</span> <span class="o">=</span> <span class="n">GetModuleHandleA</span><span class="p">(</span><span class="n">lpModuleName</span><span class="p">);</span>     <span class="c1">// GetModuleHandleA获取模块名，这里获取的模块为kernel32.dll
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">ProcAddress</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="kr">__stdcall</span> <span class="o">*</span><span class="p">)(</span><span class="n">HMODULE</span><span class="p">,</span> <span class="n">LPCSTR</span><span class="p">))</span><span class="n">GetProcAddress</span><span class="p">(</span><span class="n">hModule</span><span class="p">,</span> <span class="n">lpProcName</span><span class="p">);</span><span class="c1">// GetProcAddress获取模块中的函数，这里为AddVectoredExceptionHandler函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">ProcAddress</span><span class="p">((</span><span class="n">HMODULE</span><span class="p">)</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">LPCSTR</span><span class="p">)</span><span class="n">sub_40157F</span><span class="p">);</span>  <span class="c1">// AddVectoredExceptionHandler(1, sub_40157F);自定义异常处理
</span></span></span></code></pre></div><p>在微软的<a href="https://learn.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-addvectoredexceptionhandler?utm_source=chatgpt.com">官方文档</a>中有定义</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">PVOID</span> <span class="nf">AddVectoredExceptionHandler</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">ULONG</span>                       <span class="n">First</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">PVECTORED_EXCEPTION_HANDLER</span> <span class="n">Handler</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span></code></pre></div><blockquote>
<p>The order in which the handler should be called. If the parameter is nonzero, the handler is the first handler to be called. If the parameter is zero, the handler is the last handler to be called.
处理程序的调用顺序。如果参数为非零，则处理程序是第一个被调用的处理程序。如果参数为零，则处理程序是要调用的最后一个处理程序。
A pointer to the handler to be called.
指向要调用的处理程序的指针</p></blockquote>
<p>这里把sub_40157F设为第一个异常处理函数</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">puts</span><span class="p">(</span><span class="s">&#34;You passed level1!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">sub_4015EA</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span></code></pre></div><p>在<code>sub_4015EA</code>中有一个<code>__debugbreak();</code>函数，汇编就是<code>int 3</code>，意思就是引发一个中断，把执行权移交给调试器，如果没有调试器，那就移交给其他异常处理回调函数，如果都没有，那么程序就自己断下来，这里就是为了触发回调函数，如果没有调试器附加，那么debugbreak产生的异常会被AddVectoredExceptionHandler添加的回调函数捕获来处理，这里添加的回调函数也就是sub_40157F函数。</p>
<p>这里顺便再提一嘴Windows的异常处理机制</p>
<pre class="mermaid">flowchart LR
    A["触发异常"]-->B["调试器"]-->C["向量化异常处理(VEH)"]-->D["结构化异常处理(SEH)"]-->E["顶层未处理异常过滤器(UEF)"]
</pre>
<p>动调可以看到<code>sub_4015EA</code>输出了<code>Please enter the second Password:</code>，然后进入了上面注册的异常处理函数sub_40157F
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-23.png" alt="alt text"></p>
<p><img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-24.png" alt="alt text"><img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-25.png" alt="alt text">
很简单的逻辑，就是<code>flag2^2</code>后与<code>dword_40AD98</code>对比，已知<code>dword_40AD98 = 'u1nnf2lg'</code>，很容易推出第二段flag</p>
<h3 id="exp-2">
<a class="header-anchor" href="#exp-2"></a>
exp
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">flag1</span> <span class="o">=</span> <span class="s1">&#39;r0b0RUlez!&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;u1nnf2lg&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;flag{&#39;</span> <span class="o">+</span> <span class="n">flag1</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">flag</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span> <span class="c1">#flag要用&#39;_&#39;拼接，攻防世界没给提示，看别的wp才知道</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="4-csaw2013reversing2n4">
<a class="header-anchor" href="#4-csaw2013reversing2n4"></a>
4. csaw2013reversing2[N4]
</h2><p><a href="/process/Reverse/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/4.zip">csaw2013reversing2</a></p>
<p>题目描述：听说运行就能拿到Flag，不过菜鸡运行的结果不知道为什么是乱码</p>
<h3 id="分析-3">
<a class="header-anchor" href="#%e5%88%86%e6%9e%90-3"></a>
分析
</h3><p>根据题目的描述，先打开看看
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-26.png" alt="alt text"></p>
<p>确实是乱码，猜测程序内有对flag字符串的加密后输出，但那样就很容易得到flag，所以应该是有密文与解密函数，但没有执行解密</p>
<p>IDA打开，F5查看main伪代码
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-27.png" alt="alt text"></p>
<p>进行动调调试，断点到if语句，看到
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-28.png" alt="alt text"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00</span><span class="nf">BE108C</span> <span class="nv">call</span>    <span class="nb">ds</span><span class="p">:</span><span class="nv">IsDebuggerPresent</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00</span><span class="nf">BE1092</span> <span class="nv">test</span>    <span class="nb">eax</span><span class="p">,</span> <span class="nb">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00</span><span class="nf">BE1094</span> <span class="nv">jz</span>      <span class="nv">short</span> <span class="nv">loc_BE10B9</span>
</span></span></code></pre></div><p><code>jz      short loc_BE10B9</code>没有实现，直接执行了if外的内容
将int 3改为nop，执行完成<code>call sub_BE1000</code>，观察堆栈
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-30.png" alt="alt text"></p>
<p>看到在堆栈中有可疑的flag字符串，转到地址，发现flag
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-29.png" alt="alt text"></p>
<blockquote>
<p>flag{reversing_is_not_that_hard!}</p></blockquote>
<h3 id="exp-3">
<a class="header-anchor" href="#exp-3"></a>
exp
</h3><h2 id="5-mfc逆向-200n4">
<a class="header-anchor" href="#5-mfc%e9%80%86%e5%90%91-200n4"></a>
5. mfc逆向-200[N4]
</h2><p><a href="/process/Reverse/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/5.zip">mfc逆向-200</a></p>
<h3 id="分析-4">
<a class="header-anchor" href="#%e5%88%86%e6%9e%90-4"></a>
分析
</h3><p>查壳发现VMP壳，看来只能靠MFC的工具来逆向了</p>
<p>先运行程序，发现没有任何输入和按钮，猜测要<code>SendMessage</code>某个数据来实现输入与按钮的功能
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-31.png" alt="alt text"></p>
<p>先用xpy++分析一下，获取窗口的类名和窗口名(FindWindowA)
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-32.png" alt="alt text"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">name = &#39;Flag就在控件里&#39;
</span></span><span class="line"><span class="cl">class = &#39;944c8d100f82f0c18b682f63e4dbaa207a2f1e72581c2f1b&#39;
</span></span></code></pre></div><p>用xspy分析程序内部调用</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">message</span> <span class="n">map</span><span class="o">=</span><span class="mh">0x00588CF4</span><span class="p">(</span><span class="mi">719015</span><span class="n">c9db1242fcbc1c8617ede10401</span><span class="p">.</span><span class="n">exe</span><span class="o">+</span> <span class="mh">0x188cf4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">msg</span> <span class="n">map</span> <span class="n">entries</span> <span class="n">at</span> <span class="mh">0x00588D00</span><span class="p">(</span><span class="mi">719015</span><span class="n">c9db1242fcbc1c8617ede10401</span><span class="p">.</span><span class="n">exe</span><span class="o">+</span> <span class="mh">0x188d00</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">OnMsg</span><span class="p">:</span><span class="nf">WM_SYSCOMMAND</span><span class="p">(</span><span class="mo">0112</span><span class="p">),</span><span class="n">func</span><span class="o">=</span> <span class="mh">0x00401FD0</span><span class="p">(</span><span class="mi">719015</span><span class="n">c9db1242fcbc1c8617ede10401</span><span class="p">.</span><span class="n">exe</span><span class="o">+</span> <span class="mh">0x001fd0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">OnMsg</span><span class="p">:</span><span class="nf">WM_PAINT</span><span class="p">(</span><span class="mf">000f</span><span class="p">),</span><span class="n">func</span><span class="o">=</span> <span class="mh">0x00402080</span><span class="p">(</span><span class="mi">719015</span><span class="n">c9db1242fcbc1c8617ede10401</span><span class="p">.</span><span class="n">exe</span><span class="o">+</span> <span class="mh">0x002080</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">OnMsg</span><span class="p">:</span><span class="mo">0464</span><span class="p">,</span><span class="n">func</span><span class="o">=</span> <span class="mh">0x00402170</span><span class="p">(</span><span class="mi">719015</span><span class="n">c9db1242fcbc1c8617ede10401</span><span class="p">.</span><span class="n">exe</span><span class="o">+</span> <span class="mh">0x002170</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">OnMsg</span><span class="p">:</span><span class="nf">WM_QUERYDRAGICON</span><span class="p">(</span><span class="mo">0037</span><span class="p">),</span><span class="n">func</span><span class="o">=</span> <span class="mh">0x00402160</span><span class="p">(</span><span class="mi">719015</span><span class="n">c9db1242fcbc1c8617ede10401</span><span class="p">.</span><span class="n">exe</span><span class="o">+</span> <span class="mh">0x002160</span> <span class="p">)</span>
</span></span></code></pre></div><p>注意到<code>OnMsg:0464,func= 0x00402170(719015c9db1242fcbc1c8617ede10401.exe+ 0x002170 )</code>，应该是用户函数，尝试向程序发送0x464消息，看看会发生什么</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include&lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;windows.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">HWND</span> <span class="n">hWnd</span> <span class="o">=</span> <span class="n">FindWindow</span><span class="p">(</span><span class="s">&#34;944c8d100f82f0c18b682f63e4dbaa207a2f1e72581c2f1b&#34;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">hWnd</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">SendMessage</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span><span class="mh">0x464</span><span class="p">,</span><span class="nb">NULL</span><span class="p">,</span><span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">system</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="exp-4">
<a class="header-anchor" href="#exp-4"></a>
exp
</h3><h2 id="6-reverse-boxn5">
<a class="header-anchor" href="#6-reverse-boxn5"></a>
6. reverse-box[N5]
</h2><p><a href="/process/Reverse/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/6.zip">reverse-box</a></p>
<ul>
<li>题目描述</li>
</ul>
<p>$ ./reverse_box ${FLAG}
95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a
flag格式：TWCTF{}</p>
<h3 id="分析-5">
<a class="header-anchor" href="#%e5%88%86%e6%9e%90-5"></a>
分析
</h3><p>攻防世界没给题目描述，难怪做不出来，在别的wp里找到了描述，就是输入<code>flag</code>会输出<code>95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a</code></p>
<p>运行程序，随便输入点东西
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-34.png" alt="alt text">
每次输出都不一样，猜测有以<code>时间为种子的随机数</code>的生成</p>
<p>IDA打开，F5查看main伪代码
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-33.png" alt="alt text"></p>
<p><code>sub_804858D(v4)</code>应该对v4做了一些操作，进去看看
<img src="/post/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse/img/image-35.png" alt="alt text">
<strong>注意__ROR1__是循环右移，图中描述有误</strong></p>
<p>以时间为种子的随机数对v4进行了位操作，需要爆破种子</p>
<p>已知<strong>flag格式TWCTF{}</strong>，所以有</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">v4</span><span class="p">[</span><span class="mi">84</span><span class="p">]</span><span class="o">=</span><span class="mh">0x95</span><span class="p">,</span><span class="n">v4</span><span class="p">[</span><span class="mi">87</span><span class="p">]</span><span class="o">=</span><span class="mh">0xee</span><span class="p">,</span><span class="n">v4</span><span class="p">[</span><span class="mi">67</span><span class="p">]</span><span class="o">=</span><span class="mh">0xaf</span><span class="p">,</span><span class="n">v4</span><span class="p">[</span><span class="mi">84</span><span class="p">]</span><span class="o">=</span><span class="mh">0x95</span><span class="p">,</span><span class="n">v4</span><span class="p">[</span><span class="mi">70</span><span class="p">]</span><span class="o">=</span><span class="mh">0xef</span><span class="p">,</span><span class="n">v4</span><span class="p">[</span><span class="mi">123</span><span class="p">]</span><span class="o">=</span><span class="mh">0x94</span><span class="p">,</span><span class="n">v4</span><span class="p">[</span><span class="mi">125</span><span class="p">]</span><span class="o">=</span><span class="mh">0x4a</span>
</span></span></code></pre></div><p>那就按照这个限制条件去爆破种子，见exp</p>
<h3 id="exp-5">
<a class="header-anchor" href="#exp-5"></a>
exp
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">__ROR1__</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">b</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">n27</span><span class="p">;</span> <span class="c1">// al
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">char</span> <span class="n">n9</span><span class="p">;</span> <span class="c1">// al
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// ecx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// ecx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// ecx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// ecx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">char</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [esp+1Ah] [ebp-Eh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [esp+1Bh] [ebp-Dh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">char</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [esp+1Bh] [ebp-Dh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">char</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// [esp+1Bh] [ebp-Dh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">v16</span><span class="p">;</span> <span class="c1">// [esp+1Ch] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">a1</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">memset</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">a1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">a1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v12</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v13</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">do</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="n">n27</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">              <span class="n">n27</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v12</span> <span class="o">^=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v12</span><span class="p">)</span> <span class="o">^</span> <span class="n">n27</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v14</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v13</span><span class="p">)</span> <span class="o">^</span> <span class="n">v13</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v13</span><span class="p">)</span> <span class="o">^</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v15</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="n">v14</span><span class="p">)</span> <span class="o">^</span> <span class="n">v14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="n">v15</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="n">n9</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">              <span class="n">n9</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v13</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">^</span> <span class="n">n9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v4</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v4</span> <span class="o">=</span> <span class="n">__ROR1__</span><span class="p">(</span><span class="n">v13</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">v5</span> <span class="o">=</span> <span class="n">v4</span> <span class="o">^</span> <span class="p">(</span><span class="n">v13</span> <span class="o">^</span> <span class="o">*</span><span class="n">a1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">v6</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v6</span> <span class="o">=</span> <span class="n">__ROR1__</span><span class="p">(</span><span class="n">v13</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">v7</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">^</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v8</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v8</span> <span class="o">=</span> <span class="n">__ROR1__</span><span class="p">(</span><span class="n">v13</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">v9</span> <span class="o">=</span> <span class="n">v8</span> <span class="o">^</span> <span class="n">v7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v10</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v10</span> <span class="o">=</span> <span class="n">__ROR1__</span><span class="p">(</span><span class="n">v13</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">^</span> <span class="n">v9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">a1</span><span class="p">[</span><span class="n">v12</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">while</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">a1</span><span class="p">[</span><span class="mi">84</span><span class="p">]</span><span class="o">==</span><span class="mh">0x95</span> <span class="o">&amp;&amp;</span> <span class="n">a1</span><span class="p">[</span><span class="mi">87</span><span class="p">]</span><span class="o">==</span><span class="mh">0xee</span> <span class="o">&amp;&amp;</span> <span class="n">a1</span><span class="p">[</span><span class="mi">67</span><span class="p">]</span><span class="o">==</span><span class="mh">0xaf</span> <span class="o">&amp;&amp;</span> <span class="n">a1</span><span class="p">[</span><span class="mi">84</span><span class="p">]</span><span class="o">==</span><span class="mh">0x95</span> <span class="o">&amp;&amp;</span> <span class="n">a1</span><span class="p">[</span><span class="mi">70</span><span class="p">]</span><span class="o">==</span><span class="mh">0xef</span> <span class="o">&amp;&amp;</span> <span class="n">a1</span><span class="p">[</span><span class="mi">123</span><span class="p">]</span><span class="o">==</span><span class="mh">0x94</span> <span class="o">&amp;&amp;</span> <span class="n">a1</span><span class="p">[</span><span class="mi">125</span><span class="p">]</span><span class="o">==</span><span class="mh">0x4a</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span><span class="p">(</span><span class="n">j</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">printf</span><span class="p">(</span><span class="s">&#34;0x%02x,&#34;</span><span class="p">,</span><span class="n">a1</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xd6</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0xc2</span><span class="p">,</span><span class="mh">0xce</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0xde</span><span class="p">,</span><span class="mh">0xda</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0xb4</span><span class="p">,</span><span class="mh">0xd2</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0xc3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x37</span><span class="p">,</span><span class="mh">0x7c</span><span class="p">,</span><span class="mh">0xc8</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0xec</span><span class="p">,</span><span class="mh">0xf2</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x02</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x93</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0xc4</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xb1</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0xad</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x2f</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0xa7</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0x5e</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xbc</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0xaf</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xef</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x9c</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xe6</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0xee</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0x7e</span><span class="p">,</span><span class="mh">0x0b</span><span class="p">,</span><span class="mh">0x8c</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0xed</span><span class="p">,</span><span class="mh">0x7a</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x65</span><span class="p">,</span><span class="mh">0x5a</span><span class="p">,</span><span class="mh">0x1f</span><span class="p">,</span><span class="mh">0x4e</span><span class="p">,</span><span class="mh">0xf6</span><span class="p">,</span><span class="mh">0xf8</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0xf0</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0xb7</span><span class="p">,</span><span class="mh">0xca</span><span class="p">,</span><span class="mh">0xe5</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0x2a</span><span class="p">,</span><span class="mh">0x1d</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xe4</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0xf5</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x8d</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0x4a</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">enc</span> <span class="o">=</span> <span class="s1">&#39;95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">index</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">enc</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div>
      
    </div>
    <footer class="article-footer">
      

      

      

      

      

      

      

      
      <ul class="article-tag-list" itemprop="keywords">
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/%e9%80%86%e5%90%91"
        rel="tag"
        >逆向</a
      >
    </li>
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/%e8%ae%ad%e7%bb%83"
        rel="tag"
        >训练</a
      >
    </li>
  
</ul>

    </footer>
  </div>
  
    
  <nav
    id="article-nav"
    data-aos="fade-up"
  >
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          
          
            <img
              data-src="/images/my/9.jpg"
              data-sizes="auto"
              alt="BUU-Reverse"
              class="lazyload"
            />
          
        
        <a href="/post/buuctf-reverse/"></a>
        <div class="article-nav-caption">前一篇</div>
        <h3 class="article-nav-title">
          
            BUU-Reverse
          
        </h3>
      </div>
    

    
      <div class="article-nav-link-wrap article-nav-link-right">
        
          
          
            <img
              data-src="/images/my/16.jpg"
              data-sizes="auto"
              alt="JQCTF2025"
              class="lazyload"
            />
          
        
        <a href="/post/jqctf2025/"></a>
        <div class="article-nav-caption">后一篇</div>
        <h3 class="article-nav-title">
          
            JQCTF2025
          
        </h3>
      </div>
    
  </nav>


  
</article>






  

  

  

  

  



</section>
        </div>
        



  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  



<footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
    <div>
      <span class="icon-copyright"></span>
      
        2025
      
      <span class="footer-info-sep rotate"></span>
      Cyzrjz
    </div>
    
      <div>
        基于&nbsp;<a
          href="https://gohugo.io/"
          target="_blank"
          >Hugo</a
        >&nbsp; Theme.<a
          href="https://github.com/D-Sketon/hugo-theme-reimu"
          target="_blank"
          >Reimu</a
        >
      </div>
    
    
      <div>
        <span class="icon-brush"
          >&nbsp;
            17.5k
          </span
        >
        &nbsp;|&nbsp;
        <span class="icon-coffee">&nbsp;
          
          

          00:39
        </span>
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv"
          >总访问量&nbsp;<span
            id="busuanzi_value_site_pv"
          ></span
        ></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv"
          >总访客量&nbsp;<span
            id="busuanzi_value_site_uv"
          ></span
        ></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      
        <div class="sidebar-toc-sidebar">
          <div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#1-echo-servern3">1. echo-server[N3]</a>
      <ul>
        <li><a href="#分析">分析</a></li>
        <li><a href="#exp">exp</a></li>
      </ul>
    </li>
    <li><a href="#2-catch-men3">2. catch-me[N3]</a>
      <ul>
        <li><a href="#分析-1">分析</a></li>
        <li><a href="#exp-1">exp</a></li>
      </ul>
    </li>
    <li><a href="#3-梅津美治郎n3">3. 梅津美治郎[N3]</a>
      <ul>
        <li><a href="#分析-2">分析</a></li>
        <li><a href="#exp-2">exp</a></li>
      </ul>
    </li>
    <li><a href="#4-csaw2013reversing2n4">4. csaw2013reversing2[N4]</a>
      <ul>
        <li><a href="#分析-3">分析</a></li>
        <li><a href="#exp-3">exp</a></li>
      </ul>
    </li>
    <li><a href="#5-mfc逆向-200n4">5. mfc逆向-200[N4]</a>
      <ul>
        <li><a href="#分析-4">分析</a></li>
        <li><a href="#exp-4">exp</a></li>
      </ul>
    </li>
    <li><a href="#6-reverse-boxn5">6. reverse-box[N5]</a>
      <ul>
        <li><a href="#分析-5">分析</a></li>
        <li><a href="#exp-5">exp</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
        </div>
        <div class="sidebar-common-sidebar hidden">
          
<div class="sidebar-author">
  <img
    data-src="/avatar/avatar.png"
    data-sizes="auto"
    alt="Cyzrjz"
    class="lazyload"
  />
  <div class="sidebar-author-name">Cyzrjz</div>
  <div class="sidebar-description">静籁永恒</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    
    <div class="sidebar-state-number">11</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">
      0
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">14</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="首页"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>
        
          
            &#xe62b;
          
        
      </div>
      <div class="sidebar-menu-link">首页</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="归档"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>
        
          
            &#xe62b;
          
        
      </div>
      <div class="sidebar-menu-link">归档</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="关于"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>
        
          
            &#xe62b;
          
        
      </div>
      <div class="sidebar-menu-link">关于</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/friend"
        aria-label="友链"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>
        
          
            &#xe62b;
          
        
      </div>
      <div class="sidebar-menu-link">友链</div>
    </div>
  
</div>

        </div>
      
    
  </div>
  
    
      <div class="sidebar-btn-wrapper">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div>
    
  
</nav>

    </div>
    
      <div class="site-search">
        <div class="reimu-popup popup">
          <div class="reimu-search">
            <div class="reimu-search-input-icon"></div>
            <div class="reimu-search-input" id="reimu-search-input"></div>
            <div class="popup-btn-close"></div>
          </div>
          <div class="reimu-results">
            <div id="reimu-stats"></div>
            <div id="reimu-hits"></div>
            <div id="reimu-pagination" class="reimu-pagination"></div>
          </div>
          <img class="reimu-bg" src="/images/reimu.png" />
        </div>
      </div>
    
    
    
    






  
  
    
  
  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"
    
    
    
    
    integrity="sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf&#43;e" crossorigin="anonymous"
  ></script>




  
  
    
  
  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"
    
    
    
    
    integrity="sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"
  ></script>











  
      
      <script src="/js/main.js" integrity="" crossorigin="anonymous" ></script>
      



  





  
      
      <script src="/js/aos.js" integrity="" crossorigin="anonymous" ></script>
      

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", aosInit);
    } else {
      aosInit();
    }
  </script>








  
      
      <script src="/js/pjax_main.js" integrity="" crossorigin="anonymous" data-pjax></script>
      



  <script>
    var ALGOLIA_CONFIG = {
      logo: '\/images\/algolia_logo.svg',
      algolia: {
        applicationID: "P838ONQIH8",
        apiKey: "23e3b2dde8ed64b7219c2ba3aed27e87",
        indexName: "Myblog",
        hits: {
          "per_page": parseInt("10")
        },
        labels: {
          "input_placeholder": "搜索.....",
          "hits_empty": "未发现与 「${query}」相关内容",
          "hits_stats": "找到${hits}条结果（用时 ${time} ms）"
        }
      }
    };
  </script>
  

  
  
    
  
  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js"
    defer
    
    
    
    integrity="sha384-xvLS0jfKuoREs7pqkRI/OI8GcqohO5S&#43;jQz7ZBtQXnsXmD&#43;9jDOOY4cL6dCPzlrk" crossorigin="anonymous"
  ></script>


  

  
  
    
  
  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"
    defer
    
    
    
    integrity="sha384-hHJCflT4KBLQyHfKO9vpstIcFKn/Y&#43;KHTORelMMEn7mOp2AVPp&#43;7fr03dLgZiV3J" crossorigin="anonymous"
  ></script>


  





  
      
      <script src="/js/algolia_search.js" integrity="" crossorigin="anonymous" ></script>
      




  

  
  
    
  
  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/mouse-firework@0.1.1/dist/index.umd.js"
    
    
    
    
    integrity="sha384-8LyaidD9GPxQQgLJO/WRw/O2h3BoNq/ApI/ecpvM6RsrCz2qP2ppBXUKihP4V/2d" crossorigin="anonymous"
  ></script>


<script>
  if (window.firework) {
    const options = JSON.parse("{\"excludeelements\":[\"a\",\"button\"],\"particles\":[{\"colors\":[\"var(--red-1)\",\"var(--red-2)\",\"var(--red-3)\",\"var(--red-4)\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"emit\"],\"number\":20,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.3,0.5],\"radius\":[16,32]}},{\"colors\":[\"var(--red-0)\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"diffuse\"],\"number\":1,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.2,0.5],\"lineWidth\":6,\"radius\":20}}]}");
    options.excludeElements = options.excludeelements;
    delete options.excludeelements;
    window.firework(options);
  }
</script>





<script>
  function initLive2d() {
    live2d.init('https:\/\/fastly.jsdelivr.net\/gh\/D-Sketon\/plugin-live2d\/', {themeTipsPath: ""});
  }
</script> 

  
  
  
  
  
  
  
  
  <script
    src="https://fastly.jsdelivr.net/gh/D-Sketon/plugin-live2d/js/live2d-autoload.js"
    
    async
    
    onload="initLive2d()"
    
  ></script>






<div id="lazy-script">
  <div>
    
      
      
        
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "Cyzrjz",
          title: "攻防世界 Reverse",
          url: "https:\/\/cyzrjz.github.io\/post\/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-reverse\/",
          description: "逆向刷题",
          cover: "https:\/\/cyzrjz.github.io\/images\/my\/banner.png",
        };
      </script>
    
    
      

  
  
    
  
  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/mermaid@9.4.3/dist/mermaid.min.js"
    
    
    data-pjax
    
    integrity="sha384-aG3Gai4tbCHF0iXo48HwLoOZyut7mBl50oMC9GD1m75xyHfJDv6w8hD/kZRD47aJ" crossorigin="anonymous"
  ></script>


      

  
  
    
  
  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/dompurify@3.2.4/dist/purify.min.js"
    
    
    data-pjax
    
    integrity="sha384-eEu5CTj3qGvu9PdJuS&#43;YlkNi7d2XxQROAFYOr59zgObtlcux1ae1Il3u7jvdCSWu" crossorigin="anonymous"
  ></script>


      <script data-pjax>
        if (window.mermaid) {
          
          const elementCode = ".mermaid";
          const saveOriginalData = () => {
            return new Promise((resolve, reject) => {
              try {
                var els = _$$(elementCode),
                  count = els.length;
                els.forEach((element) => {
                  if (element.getAttribute("data-original-code") == null) {
                    element.setAttribute(
                      "data-original-code",
                      element.innerHTML,
                    );
                  }
                  count--;
                  if (count == 0) {
                    resolve();
                  }
                });
              } catch (error) {
                reject(error);
              }
            });
          };
          const resetProcessed = () => {
            return new Promise((resolve, reject) => {
              try {
                var els = _$$(elementCode),
                  count = els.length;
                els.forEach((element) => {
                  if (element.getAttribute("data-original-code") != null) {
                    element.removeAttribute("data-processed");
                    element.innerHTML = DOMPurify.sanitize(element.getAttribute("data-original-code"));
                  }
                  count--;
                  if (count == 0) {
                    resolve();
                  }
                });
              } catch (error) {
                reject(error);
              }
            });
          };
          const loadMermaid = (theme) => {
            window.mermaid.initialize({ theme });
            window.mermaid.init({ theme }, _$$(elementCode));
          };
          document.body.addEventListener("dark-theme-set", () => {
            saveOriginalData()
              .then(resetProcessed())
              .then(loadMermaid("dark"))
              .catch(console.error);
          });
          document.body.addEventListener("light-theme-set", () => {
            saveOriginalData()
              .then(resetProcessed())
              .then(loadMermaid("default"))
              .catch(console.error);
          });
          if (localStorage.getItem("dark_mode") == "true") {
            saveOriginalData()
              .then(resetProcessed())
              .then(loadMermaid("dark"))
              .catch(console.error);
          } else {
            saveOriginalData()
              .then(resetProcessed())
              .then(loadMermaid("default"))
              .catch(console.error);
          }
        }
      </script>
    
    
      





  
      
      <script src="/js/insert_highlight.js" integrity="" crossorigin="anonymous" data-pjax></script>
      

      
      
      
      
      <script type="module" data-pjax>
        
        const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;
        
        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
              
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
              
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      







  

  

  

  

  



      
    
    
  </div>
</div>




  

  
  
    
  
  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js"
    
    async
    
    
    integrity="sha384-0M75wtSkhjIInv4coYlaJU83&#43;OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id&#43;S" crossorigin="anonymous"
  ></script>





  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then((registrations) => {
        for (let registration of registrations) {
          registration.unregister();
        }
      });
    }
  </script>


<script>
  const reimuCopyright = String.raw`
   ______     ______     __     __    __     __  __    
  /\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
  \ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
   \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
    \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                    
  `;
  console.log(String.raw`%c ${reimuCopyright}`, "color: #ff5252;");
  console.log(
    "%c Theme.Reimu" + " %c https://github.com/D-Sketon/hugo-theme-reimu ",
    "color: white; background: #ff5252; padding:5px 0;",
    "padding:4px;border:1px solid #ff5252;",
  );
</script>






    
  </body>
</html>
